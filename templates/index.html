<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Traductor de Lenguaje de Señas</title>
    <style>
        body {
            font-family: sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        #video_container {
            border: 2px solid #ccc;
            margin-bottom: 20px;
            width: 640px; /* Ancho de video común */
            height: 480px; /* Alto de video común */
        }
        #output_text {
            width: 630px;
            min-height: 100px;
            font-size: 1.5em;
            padding: 10px;
            margin-top: 10px;
            border: 2px solid #333;
            resize: none;
        }
        button {
            padding: 10px 20px;
            font-size: 1.2em;
            margin-top: 10px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>Traductor de Lenguaje de Señas</h1>

    <!-- Caja de Video (la imagen se actualiza constantemente desde /video_feed) -->
    <div id="video_container">
        <img src="{{ url_for('video_feed') }}" width="100%" height="100%">
    </div>

    <h2>Frase Traducida</h2>

    <!-- Caja de Texto (se actualiza por SocketIO) -->
    <textarea id="output_text" rows="5" readonly placeholder="El texto traducido aparecerá aquí..."></textarea>
    
    <!-- Botón para borrar el texto. Llama a la función JS clearText() -->
    <button onclick="clearText()">Borrar Texto</button>

    <!-- Script de Socket.IO y funciones del lado del cliente -->
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.0/socket.io.min.js"></script>
    <script type="text/javascript">
        var socket = io();
        var outputElement = document.getElementById('output_text');

        // 1. Maneja la actualización del texto que viene del servidor (Python)
        socket.on('update_text', function(msg) {
            // Esto actualiza el contenido de la caja de texto debajo del video
            outputElement.value = msg.text;
            // Opcional: desplazar al final si el texto es muy largo
            outputElement.scrollTop = outputElement.scrollHeight;
        });

        // 2. Función llamada por el botón "Borrar Texto"
        function clearText() {
            // Envía el evento 'clear_text' al servidor, que a su vez vacía el array.
            socket.emit('clear_text'); 
            // Limpia la caja de texto localmente de inmediato para mejor experiencia de usuario
            outputElement.value = ""; 
        }

        // Si quieres que el usuario pueda escribir en la caja para editar el texto:
        // socket.on('connect', function() {
        //     outputElement.removeAttribute('readonly');
        // });
    </script>
</body>
</html>